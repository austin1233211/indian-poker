# ===========================================
# Indian Poker Server Configuration
# ===========================================
# PRODUCTION CHECKLIST:
# [ ] Set NODE_ENV=production
# [ ] Set AEAD_MASTER_KEY (CRITICAL - data loss without this!)
# [ ] Set ALLOWED_ORIGINS for WebSocket security
# [ ] Review all logging statements for sensitive data
# [ ] Enable Dependabot for dependency monitoring
# ===========================================

# Game Server Port (default: 8080)
PORT=8080

# ===========================================
# Environment Mode (CRITICAL FOR PRODUCTION)
# ===========================================
# Set to 'production' in production environments
# This enables:
# - Strict security checks
# - WSS enforcement
# - Security warnings for missing keys
# - Strict origin validation
NODE_ENV=development

# ===========================================
# AEAD Encryption - Data at Rest (CRITICAL!)
# ===========================================
# ⚠️  CRITICAL: Set AEAD_MASTER_KEY in production!
# ⚠️  WITHOUT THIS KEY: Encrypted data will be LOST on server restart!
#
# Master key for AEAD encryption (64 hex characters = 32 bytes = 256 bits)
#
# Generate with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# SECURITY BEST PRACTICES:
# - NEVER commit this key to version control
# - Store in secure secrets manager:
#   * AWS Secrets Manager
#   * HashiCorp Vault
#   * Azure Key Vault
#   * Google Cloud Secret Manager
#   * Railway environment variables (encrypted)
#
# AEAD_MASTER_KEY=<your-64-character-hex-key-here>

# Previous keys for key rotation (comma-separated hex keys)
# When rotating keys, move the old AEAD_MASTER_KEY here to allow decryption of old data
# Keep old keys for at least 24 hours after rotation to handle in-flight data
# AEAD_PREVIOUS_KEYS=<old-key-1>,<old-key-2>

# ===========================================
# WebSocket Security Configuration
# ===========================================
# Allowed origins for WebSocket connections (comma-separated)
# In production, set this to your frontend domain(s)
# Example: https://your-frontend.com,https://www.your-frontend.com
# ALLOWED_ORIGINS=https://your-frontend.com

# Allow subdomains of allowed origins (default: false)
# ALLOW_SUBDOMAINS=false

# Session idle timeout in milliseconds (default: 1800000 = 30 minutes)
# SESSION_IDLE_TIMEOUT=1800000

# ===========================================
# PIR (Private Information Retrieval) Server Integration
# ===========================================

# Set PIR_ENABLED=true to enable PIR integration for card verification
PIR_ENABLED=true

# PIR Server URL
# - Local development: http://localhost:3000
# - Railway deployment: http://indian-poker.railway.internal:3000
PIR_SERVER_URL=http://localhost:3000

# PIR Request Timeout in milliseconds (default: 5000)
PIR_TIMEOUT=5000

# Number of retry attempts for PIR requests (default: 3)
PIR_RETRY_ATTEMPTS=3

# Delay between retries in milliseconds (default: 1000)
PIR_RETRY_DELAY=1000

# PIR Server Authentication (for game server to authenticate with PIR)
# PIR_SERVER_EMAIL=gameserver@indianpoker.local
# PIR_SERVER_PASSWORD=<secure-password>

# ===========================================
# SNARK (Zero-Knowledge Proof) Integration
# ===========================================
# The groth16-snark module is integrated locally via require()
# No additional configuration needed - it auto-initializes on server start

# Enable/disable ZK proofs (default: true)
# ZK_PROOFS_ENABLED=true

# Require proofs for game progress (default: true)
# ZK_REQUIRE_PROOFS=true

# ===========================================
# Randomness Configuration
# ===========================================
# Randomness timeout in milliseconds (default: 30000)
# Time allowed for players to commit/reveal randomness seeds
# RANDOMNESS_TIMEOUT_MS=30000

# ===========================================
# Railway Deployment Configuration
# ===========================================
# When deploying to Railway, set the following environment variables
# in the Railway dashboard (NOT in code):
#
# indian-poker-server service:
#   NODE_ENV=production
#   PORT=8080
#   AEAD_MASTER_KEY=<generated-64-char-hex-key>
#   ALLOWED_ORIGINS=https://your-frontend-domain.com
#   PIR_ENABLED=true
#   PIR_SERVER_URL=http://indian-poker.railway.internal:3000
#
# pir-server service:
#   NODE_ENV=production
#   PORT=3000
#   DB_CLIENT=sqlite
#   DB_PATH=/app/data/pir_server.db
#   ENCRYPTION_SECRET=<your-32-char-secret>
#   JWT_SECRET=<your-32-char-jwt-secret>
#
# Frontend connects to indian-poker-server via public WebSocket URL:
#   wss://indian-poker-production.up.railway.app

# ===========================================
# Key Rotation Procedure
# ===========================================
# 1. Generate new AEAD_MASTER_KEY:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 2. Move current AEAD_MASTER_KEY to AEAD_PREVIOUS_KEYS
#
# 3. Set new AEAD_MASTER_KEY
#
# 4. Deploy and verify
#
# 5. After 24 hours, remove old key from AEAD_PREVIOUS_KEYS
